<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Экспортирование и импортирование символов</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2013-03-12 14:38:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt; <br />&#x003C;<a 
href="clmse61.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse59.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse59.html#tailclmse59.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="#tailclmse60.html">В-конец</a>&#x003E;&#x003C;<a 
href="xpack.html#clmse60.html" >Наверх</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">11.4
</span> <a 
href="clm.html#QQ2-76-123" id="x76-11300011.4">Экспортирование и импортирование символов</a></h3>
<!--l. 1884--><p class="noindent" >Символы из одного пакета могут стать доступными в другом пакете двумя
способами.
<!--l. 1886--><p class="indent" >   Первый способ, каждый отдельный символ может быть добавлен в пакет с
использованием функции <b><a 
href="symbols.html#x200-396492r492">import</a></b>. Форма <b>(import &#x2019;editor:buﬀer)</b> принимает
внешний символ с именем <b>buﬀer</b> в пакете <b>editor</b> (этот символ распознаётся
Lisp&#x2019;овым считывателем) и добавляет его в текущий пакет в качестве
внутреннего символа. Символ становится <em>доступным</em> в текущем пакете.
Импортированный символ автоматически не экспортируется из текущего
пакета, но если он уже существовал в пакете и был внешним, то это свойство
не меняется. После вызова <b><a 
href="symbols.html#x200-396492r492">import</a></b> в импортирующем пакете появляется
возможность ссылаться на <b>buﬀer</b> без указания полного имени. Свойства
<b>buﬀer</b> в пакете <b>editor</b> не меняются, <b>editor</b> продолжает оставаться
домашним пакетом для этого символа. Будучи импортированным, символ
будет присутствовать в пакете и может быть удалён только с помощью
вызова <b><a 
href="symbols.html#x200-396980r980">unintern</a></b>.
<!--l. 1901--><p class="indent" >   Если символ уже присутствует в импортирующем пакете, <b><a 
href="symbols.html#x200-396492r492">import</a></b> ничего
не делает. Если другой символ с таким же именем <b>buﬀer</b> уже доступен в
импортирующем пакете (напрямую или унаследован), тогда сигнализируется
исправимая ошибка, как написано в разделе <a 
href="clmse61.html#x77-11400011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>. <b><a 
href="symbols.html#x200-396492r492">import</a></b> не допускает
сокрытия одного символа другим.
<!--l. 1908--><p class="indent" >   Символ называется скрытым другим символом в некотором пакете,
когда первый символ был бы доступен через наследование, если бы
не присутствие второго символа. Для импортирования символа без
ошибки скрытия, используйте функцию <b><a 
href="symbols.html#x200-396848r848">shadowing-import</a></b>. Она
вставляет символ в указанный пакет, как внутренний символ, вне
зависимости от того, происходит ли скрытие другого символа с тем
же именем. Если другой символ с тем же именем присутствовал в
пакете, тогда этот символ сначала удаляется из пакета <b><a 
href="symbols.html#x200-396980r980">unintern</a></b>.
Новый символ добавляется в список скрывающих символов FIXME.
<b><a 
href="symbols.html#x200-396848r848">shadowing-import</a></b> должна использоваться аккуратно. Она изменяет
                                                                          

                                                                          
состояние системы пакетов так, что правила согласованности могут перестать
работать.
<!--l. 1921--><p class="indent" >   Второй способ предоставляется функцией <b><a 
href="symbols.html#x200-396995r995">use-package</a></b>. Эта функция
делает так, что пакет наследует все внешние символы некоторого другого
пакета. Эти символы становятся доступными, как <em>внутренние</em> символы,
используемого пакета. То есть, на них можно ссылаться без указания пакета
внутри текущего пакета, но они не становятся доступными в других пакетах,
использующих данный. Следует отметить, что <b><a 
href="symbols.html#x200-396995r995">use-package</a></b>, в отличие от
<b><a 
href="symbols.html#x200-396492r492">import</a></b>, не делает новые символы <em>родственными</em> в текущем пакете, а делает
их только <em>доступными</em> с помощью наследования связи символов с именами.
<b><a 
href="symbols.html#x200-396995r995">use-package</a></b> проверяет конфликты имен между импортируемыми и уже
доступными символами в импортирующем пакете. Это подробнее описано в
разделе <a 
href="clmse61.html#x77-11400011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>.
<!--l. 1933--><p class="indent" >   Обычно пользователь, по-умолчанию работая в пакете <b>common-lisp-user</b>,
будет загружать ряд пакетов в Lisp систему для предоставления
расширенного рабочего окружения, и затем вызывать <b><a 
href="symbols.html#x200-396995r995">use-package</a></b>
для каждого из этих пакетов для простого доступа к их внешним
символами. <b><a 
href="symbols.html#x200-396986r986">unuse-package</a></b> производит обратные действия относительно
<b><a 
href="symbols.html#x200-396995r995">use-package</a></b>. Внешние символы используемые пакетом перестают
наследоваться. Однако, любые импортированные символы, остаются
доступными.
<!--l. 1942--><p class="indent" >   Не существует способа наследовать <em>внутренние</em> символы другого пакета.
Для ссылки на внутренний символ, пользователь должен поменять домашний
пакет для данного символа на текущий, или использовать полное
имя (вместе с пакетом), или импортировать этот символ в текущий
пакет.
<!--l. 1947--><p class="indent" >   Различие между внешними и внутренними символами прежде всего
означает скрытие имён, так чтобы одна программа не могла использовать
пространство имён другой программы.
<!--l. 1951--><p class="indent" >   Когда <b><a 
href="symbols.html#x200-396504r504">intern</a></b> или некоторые другие функций хотят найти символ в
заданном пакете, они сначала ищут символ среди внешних и внутренних
символов текущего пакета, затем они в неопределённом порядке ищут среди
внешних символов используемых пакетов. Порядок не имеет значение. В
соответствии с правилами разрешения конфликтов имён (смотрите ниже),
если конфликтующие символы существуют в двух и более пакетах,
унаследованных пакетом <em>X</em>, символ с этим именем должен также быть в <em>X</em>,
как скрывающий символ. Конечно, реализации могут выбрать другой, более
эффективный способ для реализации такого поиска, не изменяя поведение
                                                                          

                                                                          
ранее описанного интерфейса.
<!--l. 1961--><p class="indent" >   Функция <b><a 
href="symbols.html#x200-396391r391">export</a></b> принимает символ, который доступен в некотором
указанном пакете (напрямую или унаследован из другого пакета) и делает
его внешним символом этого пакета. Если символ уже доступен как внешний,
<b><a 
href="symbols.html#x200-396391r391">export</a></b> ничего не делает. Если символ представлен, как внутренний
<em>родственный</em> символ, его статус просто меняется на внешний. Если он
доступен, как внутренний символ, полученный с помощью <b><a 
href="symbols.html#x200-396995r995">use-package</a></b>,
символ сначала импортируется в пакет, а затем делается внешним. (После
этого символ становиться импортированным в пакет и остаётся в нем, вне
зависимости от того будет ли использована <b><a 
href="symbols.html#x200-396986r986">unuse-package</a></b> или нет). Если
символ вообще недоступен в указанном пакете, то сигнализируется ошибка с
возможностью решить проблему, а, именно, какой символ должен быть
импортирован.
<!--l. 1973--><p class="indent" >   Функция <b><a 
href="symbols.html#x200-396979r979">unexport</a></b> откатывает ошибочное экспортирование символа. Она
работает только для символов напрямую представленных в текущем пакете,
меняя их свойство на «внутреннее». Если <b><a 
href="symbols.html#x200-396979r979">unexport</a></b> получает символ,
который в текущем пакете уже является внутренним, она ничего не
делает. Если получает вообще недоступный символ, то сигнализирует
ошибку.
                                                                          

                                                                          
<!--l. 1980--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="clmse61.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse59.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse59.html#tailclmse59.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="clmse60.html" >В-начало</a>&#x003E;&#x003C;<a 
href="xpack.html#clmse60.html" >Наверх</a>&#x003E;<br> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt;</div><a 
 id="tailclmse60.html"></a>
 
</body></html> 
