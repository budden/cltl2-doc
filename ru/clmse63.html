<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Функции и переменные для системы пакетов</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2013-01-10 13:49:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt; <br />&#x003C;<a 
href="number.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse62.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse62.html#tailclmse62.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="#tailclmse63.html">В-конец</a>&#x003E;&#x003C;<a 
href="xpack.html#clmse63.html" >Наверх</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">11.7
</span> <a 
href="clm.html#QQ2-79-126" id="x79-11600011.7">Функции и переменные для системы пакетов</a></h3>
<!--l. 2224--><p class="noindent" >Для описанных здесь функций, все необязательные аргументы с именем
<em>package</em> имеют значение по-умолчанию <b><a 
href="symbols.html#x188-380032r32">*package*</a></b>. Там, где функция
принимает аргумент, который может быть символом или списком символов,
значение <b><a 
href="symbols.html#x188-380670r670">nil</a></b> расценивается, как пустой список символов. Любой аргумент,
описанный как имя пакета, может быть символом или строкой. Если указан
символ, то используется его имя. Если строка, то пользователь должен
позаботиться о преобразовании регистра символов в верхний там, где это
необходимо.
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116001"></a>
<em>
<!--l. 2234--><p class="noindent" >[Переменная]</em> <b>*package*</b>
</div>
<!--l. 2236--><p class="indent" >   Значение этой переменной должно быть объектом пакета. Этот пакет
называется текущим. Первоначальное значение <b><a 
href="symbols.html#x188-380032r32">*package*</a></b> является пакетом
<b>common-lisp-user</b>.
<!--l. 2239--><p class="indent" >   Функции <b><a 
href="symbols.html#x188-380553r553">load</a></b> и <b><a 
href="symbols.html#x188-380261r261">compile-ﬁle</a></b> пересвязывают <b><a 
href="symbols.html#x188-380032r32">*package*</a></b> в текущее
значение. Если некоторая форма в файле во время загрузки изменяет
значение <b><a 
href="symbols.html#x188-380032r32">*package*</a></b>, старое значение будет восстановлено после завершения
загрузки.
<!--l. 2243--><p class="indent" >   Функция <b><a 
href="symbols.html#x188-380261r261">compile-ﬁle</a></b> пересвязывает <b><a 
href="symbols.html#x188-380032r32">*package*</a></b> в текущее значение. Если
некоторая форма в файле во время загрузки или компиляции изменяет
значение <b><a 
href="symbols.html#x188-380032r32">*package*</a></b>, старое значение будет восстановлено после завершения
функции <b><a 
href="symbols.html#x188-380261r261">compile-ﬁle</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
                                                                          

                                                                          
<a 
 id="dx79-116002"></a>
<em>
<!--l. 2250--><p class="noindent" >[Функция]</em> <b>make-package</b> <i>package-name</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:nicknames</i> <i>:use</i>
</div>
<!--l. 2252--><p class="indent" >   Эта функция создаёт и возвращает новый пакет с указанным именем. Как
было описано выше, аргументом может быть или символ, или строка.
Аргумент <b>:nicknames</b> должен быть списком строк, которые будут
псевдонимами. И здесь пользователь вместо строк может указывать
символы, в случае которых будут использоваться их имена. Это имя и
псевдонимы не могут конфликтовать с уже имеющимися именами
пакетов. Если конфликт произошёл, сигнализируется исправимая
ошибка.
<!--l. 2260--><p class="indent" >   Аргумент <b>:use</b> является списком пакетов или имён (строк или символов)
пакетов, чьи внешние символы будут унаследованы новым пакетом. Эти
пакеты должны существовать перед вызовом функции.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2266--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>in-package</b> <a 
 id="dx79-116003"></a>name
   <br>
<!--l. 2267--><p class="noindent" ></div>
</div>
<!--l. 2268--><p class="indent" >   Этот макрос пересвязывает переменную <b><a 
href="symbols.html#x188-380032r32">*package*</a></b> с пакетом, имя
которого указано в параметре <em>name</em>. Параметр <em>name</em> может быть строкой
или символом. Форма <em>name</em> не вычисляется. В случае отсутствия пакета,
сигнализируется ошибка. Кроме того, в случае вызова в качестве формы
верхнего уровня, этот макрос работает и во время компиляции.
<b>
<!--l. 2275--><p class="indent" >   <a 
href="symbols.html#x188-380493r493">in-package</a></b> возвращает новый пакет, то есть значение <b><a 
href="symbols.html#x188-380032r32">*package*</a></b> после
выполнения операции.
<hr></div>
<div class="defun">
<div class="defunheader">
                                                                          

                                                                          
<a 
 id="dx79-116004"></a>
<em>
<!--l. 2280--><p class="noindent" >[Функция]</em> <b>ﬁnd-package</b> <i>name</i>
</div>
<!--l. 2282--><p class="indent" >   Параметр <em>name</em> должен быть строкой, которая является именем или
псевдонимом искомого пакета. Этот параметр может также быть символов, в
случае которого используется имя. В результате возвращается объект пакета
с указанным именем или псевдонимом. Если пакет найден не был, то
<b><a 
href="symbols.html#x188-380420r420">ﬁnd-package</a></b> возвращает <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. Сравнение имён регистрозависимо (как в
<b><a 
href="symbols.html#x188-380924r924">string=</a></b>).
<!--l. 2289--><p class="indent" >   Аргумент <em>package</em> может быть объектом пакета, в таком случае значение
аргумента сразу возвращается. Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116005"></a>
<em>
<!--l. 2294--><p class="noindent" >[Функция]</em> <b>package-name</b> <i>package</i>
</div>
<!--l. 2296--><p class="indent" >   Аргумент должен быть объектом пакета. Данная функция возвращает
строку имени указанного пакета.
<!--l. 2299--><p class="indent" >   Кроме того функция принимает имя пакета или псевдоним, и в этом
случае возвращает главное имя пакета. Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<b>
<!--l. 2302--><p class="indent" >   <a 
href="symbols.html#x188-380707r707">package-name</a></b> возвращает <b><a 
href="symbols.html#x188-380670r670">nil</a></b> вместо имени пакета, если пакет был
удалён. Смотрите <b><a 
href="symbols.html#x188-380334r334">delete-package</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116006"></a>
<em>
<!--l. 2307--><p class="noindent" >[Функция]</em> <b>package-nicknames</b> <i>package</i>
</div>
<!--l. 2309--><p class="indent" >   Аргумент должен быть объектом пакета. Эта функция возвращает список
                                                                          

                                                                          
псевдонимов для заданного пакета, не включая главное имя.
<!--l. 2312--><p class="indent" >   Кроме того функция принимает имя пакета или псевдоним, и в этом
случае возвращается список псевдонимов пакета. Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116007"></a>
<em>
<!--l. 2317--><p class="noindent" >[Функция]</em> <b>rename-package</b> <i>package</i> <i>new-name</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>new-nicknames</i>
</div>
<!--l. 2319--><p class="indent" >   Старое имя и все старые псевдонимы пакета <em>package</em> удаляются и
заменяются на <em>new-name</em> и <em>new-nicknames</em>. Аргумент <em>new-name</em> может быть
строкой или символом. Аргумент <em>new-nicknames</em>, который по-умолчанию <b><a 
href="symbols.html#x188-380670r670">nil</a></b>,
является списком строк или символов.
<!--l. 2324--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<b>
<!--l. 2327--><p class="indent" >   <a 
href="symbols.html#x188-380808r808">rename-package</a></b> возвращает <em>package</em>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116008"></a>
<em>
<!--l. 2331--><p class="noindent" >[Функция]</em> <b>package-use-list</b> <i>package</i>
</div>
<!--l. 2333--><p class="indent" >   Данная функция возвращает список пакетов, используемых указанным в
параметре пакетом.
<!--l. 2336--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116009"></a>
                                                                          

                                                                          
<em>
<!--l. 2341--><p class="noindent" >[Функция]</em> <b>package-used-by-list</b> <i>package</i>
</div>
<!--l. 2343--><p class="indent" >   Данная функция возвращает список пакетов, использующих указанный в
параметре пакет.
<!--l. 2346--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116010"></a>
<em>
<!--l. 2351--><p class="noindent" >[Функция]</em> <b>package-shadowing-symbols</b> <i>package</i>
</div>
<!--l. 2353--><p class="indent" >   Данная функция возвращает список символов, которые были
задекларированы, как скрывающие символы, с помощью <b><a 
href="symbols.html#x188-380847r847">shadow</a></b> или
<b><a 
href="symbols.html#x188-380848r848">shadowing-import</a></b>. Все символы в этом списке является <em>родственными</em>
указанному пакету.
<!--l. 2357--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116011"></a>
<em>
<!--l. 2362--><p class="noindent" >[Функция]</em> <b>list-all-packages</b>
</div>
<!--l. 2364--><p class="indent" >   Эта функция возвращает список всех пакетов, которые существуют в
Lisp&#x2019;овой системе.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116012"></a>
                                                                          

                                                                          
<em>
<!--l. 2369--><p class="noindent" >[Функция]</em> <b>delete-package</b> <i>package</i>
</div>
<!--l. 2371--><p class="indent" >   Функция <b><a 
href="symbols.html#x188-380334r334">delete-package</a></b> удаляет указанный в аргументе <em>package</em> пакет,
из всех структур данных системы пакетов. Аргумент <em>package</em> может быть как
пакетом, так и его именем.
<!--l. 2375--><p class="indent" >   Если <em>package</em> является именем, но пакета с данным именем не
существует, сигнализируется исправимая ошибка. Продолжение из этой
ошибки не делает попытку удаления, но возвращает <b><a 
href="symbols.html#x188-380670r670">nil</a></b> из вызова
<b><a 
href="symbols.html#x188-380334r334">delete-package</a></b>.
<!--l. 2379--><p class="indent" >   Если <em>package</em> является пакетов, но пакет уже был удалён, ошибка не
сигнализируется и попыток удаления не происходит. Вместо этого
<b><a 
href="symbols.html#x188-380334r334">delete-package</a></b> немедленно возвращает <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 2383--><p class="indent" >   Если пакет, указанный для удаления, в этот момент используется
другими пакетами, сигнализируется исправимая ошибка. Продолжение из
этой ошибки выглядит как, если бы функция <b><a 
href="symbols.html#x188-380986r986">unuse-package</a></b> была
выполнена на всех использующих пакетах для удаления зависимостей, после
чего была вызвана <b><a 
href="symbols.html#x188-380334r334">delete-package</a></b> для удаления пакета.
<!--l. 2389--><p class="indent" >   Если указанный пакет является домашним для некоторого символа, тогда
после выполнения <b><a 
href="symbols.html#x188-380334r334">delete-package</a></b>, ячейка домашнего пакета символа
становится неопределённой. Никак по-другому символы в удаляемом пакете
не модифицируются.
<!--l. 2393--><p class="indent" >   Имя и псевдонимы пакета <em>package</em> перестают быть сами собой. Объект
пакета остаётся, но анонимно: <b><a 
href="symbols.html#x188-380712r712">packagep</a></b> будет истинным, но <b><a 
href="symbols.html#x188-380707r707">package-name</a></b>
применительно к нему будет возвращать <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 2397--><p class="indent" >   Влияние любой другой операции на удалённым объектом пакета не
определена. В частности, попытка найти символ в удалённый пакет
(например, используя <b><a 
href="symbols.html#x188-380504r504">intern</a></b> или <b><a 
href="symbols.html#x188-380422r422">ﬁnd-symbol</a></b>) будет иметь неопределённый
результат.
<!--l. 2401--><p class="indent" >   Если удаление было успешно, <b><a 
href="symbols.html#x188-380334r334">delete-package</a></b> возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>, иначе
<b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116013"></a>
<em>
                                                                          

                                                                          
<!--l. 2405--><p class="noindent" >[Функция]</em> <b>intern</b> <i>string</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2407--><p class="indent" >   В пакете <em>package</em>, который по-умолчанию равен текущему пакету,
осуществляется поиск символа с именем, указанным в аргументе <em>string</em>. Этот
поиск будет включить унаследованные символы, как описано в разделе <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>.
Если ни одного символа не найдено, то символ создаётся и устанавливается
в указанный пакет в качестве внутреннего символа (или внешнего
символа, если пакет <b>keyword</b>). Указанный пакет становиться домашним
пакетом для созданного символа. Возвращается два значения. Первое
является символом, который был найден или создан. Второе значение <b><a 
href="symbols.html#x188-380670r670">nil</a></b>,
если символ не существовал ранее, или одно из следующих значений:
<div class="indentdesc">
      <ul><li><b>
<b>:internal</b> </b></li>Символ напрямую представлен в пакете как внутренний символ.
      <li><b>
<b>:external</b> </b></li>Символ напрямую представлен в пакете как внешний символ.
      <li><b>
<b>:inherited</b> </b></li>Символ  унаследован  с  помощью  <b><a 
href="symbols.html#x188-380995r995">use-package</a></b>  (и  следовательно
      символ является внутренним).</ul>
</div>
<!--l. 2428--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116014"></a>
<em>
<!--l. 2433--><p class="noindent" >[Функция]</em> <b>ﬁnd-symbol</b> <i>string</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2435--><p class="indent" >   Эта функция идентична <b><a 
href="symbols.html#x188-380504r504">intern</a></b>, но она никогда не создаёт новый символ.
Если символ с указанным именем был найден в указанном пакете, напрямую
или через наследование, найденный возвращается символ как первое
значение и второе значение так же как в <b><a 
href="symbols.html#x188-380504r504">intern</a></b>. Если символ не доступен в
заданном пакете, оба значения равны <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
                                                                          

                                                                          
<!--l. 2441--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116015"></a>
<em>
<!--l. 2446--><p class="noindent" >[Функция]</em> <b>unintern</b> <i>symbol</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2448--><p class="indent" >   Если указанный символ представлен в указанном пакете <em>package</em>, он
удаляется из этого пакета и также из списка скрывающих символов,
если он там был. Кроме того, если <em>package</em> для символа является
домашним пакетом, то символ отсоединяется и становится бездомным.
Следует отметить, что в некоторых обстоятельствах может продолжить
быть доступным с помощью наследования в указанном пакете. Если
удаление действительно произошло, <b><a 
href="symbols.html#x188-380980r980">unintern</a></b> возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>, иначе
<b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<b>
<!--l. 2457--><p class="indent" >   <a 
href="symbols.html#x188-380980r980">unintern</a></b> должна использоваться с осторожностью. Она изменяет
состояние системы пакетов так, что правила согласованности перестают
действовать.
<!--l. 2460--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116016"></a>
<em>
<!--l. 2465--><p class="noindent" >[Функция]</em> <b>export</b> <i>symbols</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2467--><p class="indent" >   Аргумент <em>symbols</em> должен быть списком символов или одиночным
символом. Эти символы становятся доступными как внешние символы в
пакете <em>package</em> (смотрите раздел <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <b><a 
href="symbols.html#x188-380391r391">export</a></b> возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<!--l. 2472--><p class="indent" >   По соглашению, вызов <b><a 
href="symbols.html#x188-380391r391">export</a></b> содержит все экспортируемые символы и
                                                                          

                                                                          
помещается рядом с началом файла, для указания того, какие символы
экспортируются данным файлом для использования другими программами.
<!--l. 2476--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116017"></a>
<em>
<!--l. 2481--><p class="noindent" >[Функция]</em> <b>unexport</b> <i>symbols</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2483--><p class="indent" >   Аргумент <em>symbols</em> должен быть списком символов или одиночным
символом. Эти символы становятся внутренними символами в пакете
<em>package</em>. Использование этой операции для символов пакета <b>keyword</b>
является ошибкой. (смотрите раздел <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <b><a 
href="symbols.html#x188-380979r979">unexport</a></b> возвращает
<b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<!--l. 2489--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116018"></a>
<em>
<!--l. 2494--><p class="noindent" >[Функция]</em> <b>import</b> <i>symbols</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2496--><p class="indent" >   Аргумент <em>symbols</em> должен быть списком символов или одиночным
символом. Эти символы становятся внутренними символами в пакете <em>package</em>
и, таким образом, могут быть указаны без использования полного имени (с
двоеточием). <b><a 
href="symbols.html#x188-380492r492">import</a></b> сигнализирует исправимую ошибку, если любой
из импортируемых символов имеет такое же имя, как один из уже
присутствующих в пакете символов (смотрите раздел <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). <b><a 
href="symbols.html#x188-380492r492">import</a></b>
возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<!--l. 2504--><p class="indent" >   Если любой импортируемый символ не имеет домашнего пакета,
тогда <b><a 
href="symbols.html#x188-380492r492">import</a></b> устанавливает домашний пакет тот, в который символ
импортируется.
                                                                          

                                                                          
<!--l. 2507--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116019"></a>
<em>
<!--l. 2512--><p class="noindent" >[Функция]</em> <b>shadowing-import</b> <i>symbols</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2514--><p class="indent" >   Данная функция похожа на <b><a 
href="symbols.html#x188-380492r492">import</a></b>, но не сигнализирует ошибку, даже
если импортирование символа будет скрывать некоторый другой символ, уже
присутствующий в пакете. В дополнение к импортированию символ
помещается в список скрывающих символов пакета <em>package</em> (смотрите
раздел <a 
href="clmse61.html#x77-11400011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>). <b><a 
href="symbols.html#x188-380848r848">shadowing-import</a></b> возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<b>
<!--l. 2521--><p class="indent" >   <a 
href="symbols.html#x188-380848r848">shadowing-import</a></b> должна использоваться с осторожностью. Она
изменяет состояние системы пакетов так, что правила согласованности
перестают действовать.
<!--l. 2524--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116020"></a>
<em>
<!--l. 2529--><p class="noindent" >[Функция]</em> <b>shadow</b> <i>symbols</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2531--><p class="indent" >   Аргумент должен быть списком символов или строк или одиночным
символом или строкой. Рассматривается имя каждого символа (или просто
строка) и в указанном пакете <em>package</em> ищется символ с таким же именем.
Если данный символ присутствует в этом пакете (напрямую, а не с помощью
наследования), тогда он добавляется в список скрывающих символов. Иначе,
создаётся новый символ с указанным именем, и вставляется в пакет <em>package</em>
как внутренний символ. Символ также помещается в список затеняющих
                                                                          

                                                                          
символов пакета <em>package</em> (смотрите раздел <a 
href="clmse61.html#x77-11400011.5">11.5<!--tex4ht:ref: NAME-CONFLICTS-SECTION --></a>). <b><a 
href="symbols.html#x188-380847r847">shadow</a></b> возвращает
<b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<b>
<!--l. 2541--><p class="indent" >   shadowing</b> должна использоваться с осторожностью. Она изменяет
состояние системы пакетов так, что правила согласованности перестают
действовать.
<!--l. 2544--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116021"></a>
<em>
<!--l. 2549--><p class="noindent" >[Функция]</em> <b>use-package</b> <i>packages-to-use</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2551--><p class="indent" >   Аргумент <em>packages-to-use</em> должен быть списком пакетов или их имён или
одиночным пакетом или его именем. Эти пакеты добавляются в список
использования <em>package</em>, если их там ещё нет. Все внешние символы в пакетах
становятся доступными в пакете <em>package</em> как внутренние символы
(смотрите раздел <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>). Использование пакета <b>keyword</b> является ошибкой.
<b><a 
href="symbols.html#x188-380995r995">use-package</a></b> возвращает <b><a 
href="symbols.html#x188-380951r951">t</a></b>.
<!--l. 2559--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116022"></a>
<em>
<!--l. 2564--><p class="noindent" >[Функция]</em> <b>unuse-package</b> <i>packages-to-unuse</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>package</i>
</div>
<!--l. 2566--><p class="indent" >   Аргумент <em>packages-to-use</em> должен быть списком пакетов или их имён или
одиночным пакетом или его именем. Эти пакеты удаляются из списка
использования <em>package</em>, если они там были. <b><a 
href="symbols.html#x188-380986r986">unuse-package</a></b> возвращает
<b><a 
href="symbols.html#x188-380951r951">t</a></b>.
                                                                          

                                                                          
<!--l. 2571--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2576--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>defpackage</b> <a 
 id="dx79-116023"></a>deﬁned-package-name {option}*
   <br>
<!--l. 2577--><p class="noindent" ></div>
</div>
<!--l. 2578--><p class="indent" >   Эта функция создаёт новый пакет, или модифицирует уже существующий,
имя которого является <em>deﬁned-package-name</em>. Аргумент <em>deﬁne-package-name</em>
может быть строкой или символом. Если он является символом, то
используется его имя, а не пакет, если вдруг в котором находится данный
символ. Созданный или модифицированный пакет возвращается как
значение формы <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>.
<div class="flushdesc">
      <ul><li><b>
<b>(:size <em>integer</em>)</b> </b></li>Запись   указывает   примерное   количество   символов
      ожидаемых быть в пакете. Это просто подсказка для менеджера
      памяти так, что реализация используя хеш-таблицы для хранения
      структуры  пакета  может  указать  данный  параметр,  и  память
      будет более эффективно выделяться (удобно, например при чтении
      файла и всех его символов в пакет).
      <li><b>
<b>(:nicknames  {<i><em></em></i>}* package-name)</b> </b></li>Запись  указывает  псевдонимы  для
      пакета. Если один из псевдонимов уже указывает на имеющийся
      пакет, то сигнализируется исправимая ошибка, как для функции
      <b><a 
href="symbols.html#x188-380601r601">make-package</a></b>.
      <li><b>
<b>(:shadow  {<i><em></em></i>}* symbol-name)</b> </b></li>Указывает   имена   символов,   которые
      будут затеняющими в определяемом пакете. Работает как <b><a 
href="symbols.html#x188-380847r847">shadow</a></b>.
                                                                          

                                                                          
      <li><b>
<b>(:shadowing-import-from <em>package-name</em> {<i><em></em></i>}* symbol-name)</b> </b></li>
      Указывает                            имена                            символов,
      которые будут размещены в определяемом пакете. Эти символы
      импортируются в пакет, будучи при необходимости затеняющими,
      как при использовании функции <b><a 
href="symbols.html#x188-380848r848">shadowing-import</a></b>. Ни в коем
      случае символы не создаются. Если для любого имени <em>symbol-name</em>
      не существует символа доступного в пакете с именем <em>package-name</em>,
      то сигнализируется исправимая ошибка.
      <li><b>
<b>(:use  {<i><em></em></i>}* package-name)</b> </b></li>Указывает                          определяемому
      пакету «использовать» (наследовать от) пакеты указанные в этой
      опции. Работает также, как и <b><a 
href="symbols.html#x188-380995r995">use-package</a></b>. Если <b>:use</b> не указана,
      тогда опция имеет неопределённое значение.
      <li><b>
<b>(:import-from <em>package-name</em> {<i><em></em></i>}* symbol-name)</b> </b></li>Указывает
      символы, которые будут размещены в определяемом пакете. Эти
      символы импортируются в пакет, как при использовании функции
      <b><a 
href="symbols.html#x188-380848r848">shadowing-import</a></b>. Ни в коем случае символы не создаются. Если
      для любого имени <em>symbol-name</em> не существует символа доступного
      в пакете с именем <em>package-name</em>, то сигнализируется исправимая
      ошибка.
      <li><b>
<b>(:intern  {<i><em></em></i>}* symbol-name)</b> </b></li>Указанные   символы   размещаются   или
      создаются в определяемом пакете, как при использовании функции
      <b><a 
href="symbols.html#x188-380504r504">intern</a></b>. Следует отметить, что действие этой опции может зависеть
      от опции <b>:use</b>, так как преимущество отдаётся унаследованному
      символу, чем созданию нового.
      <li><b>
<b>(:export  {<i><em></em></i>}* symbol-name)</b> </b></li>Указанные  символы  размещаются  или
      создаются  в  определяемом  пакете  и  затем  экспортируются,  как
      при  использовании  функции  <b><a 
href="symbols.html#x188-380391r391">export</a></b>.  Следует  отметить,  что
      действие этой опции может зависеть от опции <b>:use</b>, <b>import-from</b>
      или  <b>shadowing-import-from</b>  так  как  преимущество  отдаётся
      унаследованному или импортированному символу, чем созданию
                                                                          

                                                                          
      нового.</ul>
</div>
<!--l. 2637--><p class="indent" >   Порядок, в котором опции используются в форме <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>, не имеет
значения. Часть соглашения в том, что <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> сортирует опции
перед обработкой. Опции обрабатываются в следующем порядке:
<div class="tabbing">
1.  <b>:shadow</b> and <b>:shadowing-import-from</b>
   <br>                  2.  <b>:use</b><br>                  3.  <b>:import-from</b> and <b>:intern</b><br>
4.  <b>:export</b><br>
<!--l. 2646--><p class="noindent" ></div>Сначала устанавливаются затенения, чтобы избежать ложных конфликтов при
установке связей для use. Связи use должны устанавливаться перед
импортированием и интернированием, таким образом эти операции могут
ссылаться на нормально унаследованные символы, а не создавать новые.
Экспортирование выполняется последним, таким образом символы созданные
любой другой операцией, в частности, затеняющие и импортированные символы,
могут быть экспортированы. Следует отметить, что экспортирование
унаследованного символа сначала неявно импортирует его (смотрите
раздел <a 
href="clmse60.html#x76-11300011.4">11.4<!--tex4ht:ref: EXPORT-IMPORT-SECTION --></a>).
<!--l. 2656--><p class="indent" >   Если пакета с именем <em>deﬁned-package-name</em> не существовало, то
<b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> создаст его. Если такой пакет уже существовал, то новый пакет
создан не будет. Существующий пакет модифицируется, если возможно, для
отражения нового определения. Результат не определён, если новое
определение не совместимо с текущим состоянием пакета.
<!--l. 2662--><p class="indent" >   Если одинаковый аргумент <b><a 
href="symbols.html#x188-380945r945">symbol-name</a></b> (в смысле сравнения имён с
помощью <b><a 
href="symbols.html#x188-380924r924">string=</a></b>) встречается более одного раза в опциях <b>:shadow</b>,
<b>:shadowing-import-from</b>, <b>:import-from</b> и <b>:intern</b>, сигнализируется
ошибка.
<!--l. 2667--><p class="indent" >   Если одинаковый аргумент <b><a 
href="symbols.html#x188-380945r945">symbol-name</a></b> (в смысле сравнения имён с
помощью <b><a 
href="symbols.html#x188-380924r924">string=</a></b>) встречается более одного раза в опциях <b>:intern</b> и <b>:export</b>,
сигнализируется ошибка.
<!--l. 2671--><p class="indent" >   Другие виды конфликтов обрабатывается в том же стиле, как в
соответствующих операциях <b><a 
href="symbols.html#x188-380995r995">use-package</a></b>, <b><a 
href="symbols.html#x188-380492r492">import</a></b> и <b><a 
href="symbols.html#x188-380391r391">export</a></b>.
<!--l. 2674--><p class="indent" >   Реализация может поддерживать другие опции для <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>.
Каждая реализация должно сигнализировать ошибку при встрече с
                                                                          

                                                                          
неподдерживаемой опцией для <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>.
<!--l. 2678--><p class="indent" >   Функция <b><a 
href="symbols.html#x188-380261r261">compile-ﬁle</a></b> должна обрабатывается формы верхнего уровня
<b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> таким же методом, как и обрабатывает формы верхнего уровня
для работы с пакетам (как описано в начале раздела <a 
href="#x79-11600011.7">11.7<!--tex4ht:ref: PACKAGE-FUNCTIONS-SECTION --></a>).
<!--l. 2682--><p class="indent" >   Вот пример вызова <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>, которая «не рискует (plays it safe)»,
используя только строки в качестве имён. <div class="lisp"><tt><div class="tabbing">
(cl:defpackage &#x0022;MY-VERY-OWN-PACKAGE&#x0022;
   <br>         (:size 496)<br>         (:nicknames &#x0022;MY-PKG&#x0022; &#x0022;MYPKG&#x0022; &#x0022;MVOP&#x0022;)<br>
  (:use &#x0022;COMMON-LISP&#x0022;)<br>                     (:shadow &#x0022;CAR&#x0022; &#x0022;CDR&#x0022;)<br>
  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;CONS&#x0022;)<br>
  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; &#x0022;BLINK-FRONT-PANEL-LIGHTS&#x0022;)<br>
  (:export &#x0022;EQ&#x0022; &#x0022;CONS&#x0022; &#x0022;MY-VERY-OWN-FUNCTION&#x0022;))<br>
<!--l. 2693--><p class="noindent" ></div>
</tt>
</div>
<b>
<!--l. 2694--><p class="indent" >   <a 
href="symbols.html#x188-380322r322">defpackage</a></b> пример выше спроектирован работать корректно, даже если
текущий пакет не использует пакет <b>common-lisp</b>. (Следует отметить, что в
этом примере используется псевдоним <b>cl</b> для пакета <b>common-lisp</b>.) Более
того, выполнение этой формы <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> не создаст символа в текущем
пакете. А также для последующего удобства для строк использованы буквы
в верхнем регистре.
______________________________________________________<div class="implementation">
<!--l. 2702--><p class="noindent" ><b>Заметка для реализации:</b> An implementation of <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> might choose
to transform all the <em>package-name</em> and <em>symbol-name</em> arguments into strings
at macro expansion time, rather than at the time the resulting expansion is
executed, so that even if source code is expressed in terms of strange symbols
in the <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> form, the binary ﬁle resulting from compiling the source
code would contain only strings. The purpose of this is simply to minimize the
creation of useless symbols in production code. This technique is permitted as an
implementation strategy but is not a behavior required by the speciﬁcation of
<b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>.
</div>___________________________________________________________________________________________________________
                                                                          

                                                                          
<!--l. 2716--><p class="indent" >   А вот для контраста пример <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>, который «играет по крупному
(plays the whale)» с использованием всех типов допустимого синтаксиса.
<div class="lisp"><tt><div class="tabbing">
(defpackage my-very-own-package
   <br>                      (:export :EQ common-lisp:cons my-very-own-function)<br>
  (:nicknames &#x0022;MY-PKG&#x0022; #:MyPkg)<br>           (:use &#x0022;COMMON-LISP&#x0022;)<br>
  (:shadow &#x0022;CAR&#x0022;)<br>             (:size 496)<br>             (:nicknames mvop)<br>
  (:import-from &#x0022;BRAND-X-LISP&#x0022; &#x0022;GC&#x0022; Blink-Front-Panel-Lights)<br>
  (:shadow common-lisp::cdr)<br>
  (:shadowing-import-from &#x0022;BRAND-X-LISP&#x0022; CONS))<br>
<!--l. 2729--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2730--><p class="indent" >   Этот пример производит то же влияние на вновь созданный пакет, но
может создавать бесполезные символы в других пакетах. Использования
явных тегов пакетов особенно запутаны. Например, эта форма <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>
делает так, что символ <b><a 
href="symbols.html#x188-380209r209">cdr</a></b> будет затенён в <em>новом пакете</em>. Данный символ не
будет затенён в пакете <b>common-lisp</b>. Факт, что имя «<b>CDR</b>» было указано
полным именем (с двоеточием) является отвлекающим маневром. Мораль в
том, что синтаксическая гибкость <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b>, как в других частях Common
Lisp&#x2019;а, даёт большие удобства в использовании в рамках здравого смысла, но
создаёт невообразимую путаницу при использовании мальтузианского
изобилия.
<!--l. 2741--><p class="indent" >   Следует отметить, что <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> не способна сама по себе определять
взаимно рекурсивные пакеты, например, два пакета использующих друг
друга. Однако, ничто не мешает использовать <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> для выполнения
первоначальных установок, а затем использовать такие функции, как
<b><a 
href="symbols.html#x188-380995r995">use-package</a></b>, <b><a 
href="symbols.html#x188-380492r492">import</a></b> и <b><a 
href="symbols.html#x188-380391r391">export</a></b> для создания связи.
<!--l. 2747--><p class="indent" >   Цель <b><a 
href="symbols.html#x188-380322r322">defpackage</a></b> поощрять пользователя размещать определение
пакета и его зависимостей в одном месте. Это может также позволить
проектировщику большой системы размещать определения всех необходимых
пакетов (скажем) в один файл, который может быть загружен перед
загрузкой или компиляцией кода, который зависит от этих пакетов. Такой
файл, если аккуратно сконструирован, может быть просто загружен в пакет
<b>common-lisp-user</b>.
                                                                          

                                                                          
<!--l. 2754--><p class="indent" >   Реализации и программные окружения могут также лучше поддерживать
процесс разработки (если только предлагая лучшую проверку ошибок) с
помощью глобальной базы значений о предполагаемых установках
пакетов.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx79-116024"></a>
<em>
<!--l. 2760--><p class="noindent" >[Функция]</em> <b>ﬁnd-all-symbols</b> <i>string-or-symbol</i>
</div>
<b>
<!--l. 2762--><p class="indent" >   <a 
href="symbols.html#x188-380414r414">ﬁnd-all-symbols</a></b> просматривает каждый пакет в Lisp&#x2019;овой системе для
поиска символа, имя которого совпадает с указанной строкой. Список всех
найденных символов возвращается в качестве результата. Этот поиск
регистрозависимый. Если аргумент является символом, для поиска по строке
используется его имя.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2771--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>do-symbols</b> <a 
 id="dx79-116025"></a>(var [package [result-form]]){declaration}* {tag | statement}*
   <br>
<!--l. 2773--><p class="noindent" ></div>
</div>
<b>
<!--l. 2774--><p class="indent" >   <a 
href="symbols.html#x188-380351r351">do-symbols</a></b> предоставляет прямой цикл по символам пакета. Тело
выполняется единожды для каждого символа доступного в пакете <em>package</em>.
Символ связывается с переменной <em>var</em>. Затем вычисляется форма <em>result-form</em>
(одиночная форма, <em>не</em> неявный <b><a 
href="symbols.html#x188-380761r761">progn</a></b>), и результат является результатом
формы <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b>. (Когда вычисляется форма <em>result-form</em>, переменная <em>var</em>
продолжает быть связанной и имеет значение <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.) Если <em>result-form</em> опущена,
результат <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. Для немедленного завершения цикла может использоваться
<b><a 
href="symbols.html#x188-380816r816">return</a></b>. Если выполнение тела влияет на то, какие символы содержаться в
                                                                          

                                                                          
пакете <em>package</em>, то возможно только удаление символа связанного
с переменной <em>var</em> с использованием <b><a 
href="symbols.html#x188-380980r980">unintern</a></b>, иначе результат не
определён.
<!--l. 2787--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<div class="new">
<!--l. 2791--><p class="indent" >   Тело <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b> для одного и того же символа может быть выполнено
несколько раз, пользователь должен сам следить за этим.
<!--l. 2794--><p class="indent" >   Фишка в том, что один и тот же символ может быть доступен с помощью
нескольких цепочек наследования, и для реализаций дорого следить за этим.
Например: <div class="lisp"><tt><div class="tabbing">
(setq *a* (make-package &#x2019;a))      ;Неявно использует <b>common-lisp</b>
   <br> (setq *b* (make-package &#x2019;b))      ;Неявно использует <b>common-lisp</b><br>
(setq *c* (make-package &#x2019;c :use &#x2019;(a b)))<br>                                    <br>
(do-symbols (x *c*) (print x))    ;Символы пакета <b>common-lisp</b><br>
                                  ; могут быть выведены один или два раза<br>
<!--l. 2804--><p class="noindent" ></div>
</tt>
</div>
</div>
<!--l. 2808--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
<!--l. 2811--><p class="indent" >   Следует отметить, что конструкция <b><a 
href="symbols.html#x188-380577r577">loop</a></b> предоставляет тип выражения
<b><a 
href="symbols.html#x188-380436r436">for</a></b>, которое может проходить в цикле по символам пакета (смотрите
главу <a 
href="loop.html#x154-22600025">25<!--tex4ht:ref: LOOP --></a>).
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2816--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>do-external-symbols</b> <a 
 id="dx79-116026"></a>(var [package [result]]){declaration}* {tag | statement}*
   <br>
<!--l. 2818--><p class="noindent" ></div>
                                                                          

                                                                          
</div>
<b>
<!--l. 2819--><p class="indent" >   <a 
href="symbols.html#x188-380350r350">do-external-symbols</a></b> похожа на <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b> за исключением того, что
сканируются только внешние символы пакета.
<div class="new">
<!--l. 2823--><p class="indent" >   The clariﬁcation voted by X3J13 in March 1988 for <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b> <a 
 id="dx79-116027"></a>, regarding
redundant executions of the body for the same symbol, applies also to
<b><a 
href="symbols.html#x188-380350r350">do-external-symbols</a></b>.
</div>
<!--l. 2830--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<!--l. 2833--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2838--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>do-all-symbols</b> <a 
 id="dx79-116028"></a>(var [result-form]){declaration}* {tag | statement}*
   <br>
<!--l. 2840--><p class="noindent" ></div>
</div>
<!--l. 2841--><p class="indent" >   Эта функция похожа на <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b>, но выполняет тело единожды для
каждого символа каждого пакета. (Функция не обрабатывает все
возможные символы, так как символ может быть доступен ни в одном
пакете. Обычно, дезинтернированые символы не доступны ни в одном
пакете.) В общем случае тело может выполняться для одно символа
несколько раз, так как этот символ может встречаться в нескольких
пакетах.
<div class="new">
<!--l. 2849--><p class="indent" >   The clariﬁcation voted by X3J13 in March 1988 for <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b> <a 
 id="dx79-116029"></a>, regarding
redundant executions of the body for the same symbol, applies also to
<b><a 
href="symbols.html#x188-380349r349">do-all-symbols</a></b>.
</div>
<!--l. 2856--><p class="indent" >   Аргумент <em>package</em> может быть как объектом пакета, так и его именем.
Смотрите раздел <a 
href="clmse58.html#x74-11100011.2">11.2<!--tex4ht:ref: PACKAGE-NAMES-SECTION --></a>.
<!--l. 2859--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
                                                                          

                                                                          
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2864--><p class="indent" >   <div class="tabbing">
 <em>[Макрос]</em> <b>with-package-iterator</b> <a 
 id="dx79-116030"></a>(mname package-list {symbol-type}+){form}*
   <br>
<!--l. 2866--><p class="noindent" ></div>
</div>
<!--l. 2867--><p class="indent" >   Имя <em>mname</em> связывается и определяется как если бы с помощью
<b><a 
href="symbols.html#x188-380587r587">macrolet</a></b>, лексически для тела <em>form</em>, и является «генератором», таким
образом, что каждый вызов <b>(<em>mname</em>)</b> будет возвращать следующий символ,
из списка всех символов, которые присутствуют в пакетах, перечисленных в
списке полученным от выражения <em>package-list</em> (которое вычисляется
единожды).
<!--l. 2874--><p class="indent" >   Каждый элемент значения <em>package-list</em> может быть или объектом пакета
или его именем. Кроме того, если значение <em>package-list</em> является просто
объектом пакета или его и именем, то оно трактуется как список с одним
этим элементом. Если значение <em>package-list</em> равно <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, то трактуется как
пустой список.
<!--l. 2880--><p class="indent" >   При каждом вызове «генератора» возможны два исхода. Если
символы для обработки ещё есть, возвращается четыре значения: <b><a 
href="symbols.html#x188-380951r951">t</a></b>,
символ, ключевой символ, который характеризует искомый символ
(смотрите ниже) и пакет, в котором данный символ доступен. Если
символом для обработки не осталось, то возвращается одно значение:
<b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 2887--><p class="indent" >   Когда «генератор» во втором значении возвращает символ, четвёртое
значение это всегда пакет из списка, который был получен в <em>package-list</em>, и
третье значение характеризует искомый символ так: <b>:internal</b> означает,
что символ внутренний; <b>:external</b> означает, что символ внешний
(экспортированный); и <b>:inherited</b> означает, что символ не представлен
(следовательно не скрыт), но унаследован из некоторого другого пакета,
который используется в пакете из четвёртого значения.
<!--l. 2897--><p class="indent" >   Элементы <em>symbol-type</em> в вызове <b><a 
href="symbols.html#x188-381021r1021">with-package-iterator</a></b> не вычисляются.
Их может быть несколько, порядок не имеет значения. Они указывают на
свойства интересующих пользователя символов. Символ будет возвращён из
                                                                          

                                                                          
«генератора» только если его свойство было указано в <em>symbol-type</em>.
Стандартными значениями <em>symbol-type</em> являются <b>:internal</b>, <b>:external</b>,
<b>:inherited</b>, но реализации могут добавлять свои свойства. В случае если
в <em>symbol-type</em> не указано ни одно свойство, или если указанные не
поддерживаются реализацией, сигнализируется ошибка.
<!--l. 2907--><p class="indent" >   Порядок, в котором возвращаются символы с помощью «генератора»,
никак не коррелирует с порядком перечисления пакетов в <em>package-list</em>. При
наличии в <em>package-list</em> более одного пакета, символы, которые доступны более
чем из одного пакета могут быть возвращены один или более раз. Даже если
указан только один пакет, символы унаследованные различными путями
могут быть обработаны один или несколько раз.
<!--l. 2916--><p class="indent" >   Неявное состояние перечисления символов имеет динамическую
продолжительность жизни. После завершения формы <b><a 
href="symbols.html#x188-381021r1021">with-package-iterator</a></b>
вызов «генератора» приведёт к ошибке.
<!--l. 2921--><p class="indent" >   Любое количество вызовов <b><a 
href="symbols.html#x188-381021r1021">with-package-iterator</a></b> и связанных с ними
макросов может быть вложенным.
<!--l. 2924--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
____________________________________________________<div class="rationale">
<!--l. 2928--><p class="noindent" ><b>Обоснование:</b> Этот функция в некотором смысле более гибкий, чем <b><a 
href="symbols.html#x188-380351r351">do-symbols</a></b> и
подобные ей функции. В частности, он позволяет реализовать подвыражения для
<b><a 
href="symbols.html#x188-380577r577">loop</a></b> для итераций над символами пакетов и переносимо, и эффективно (смотрите
главу <a 
href="loop.html#x154-22600025">25<!--tex4ht:ref: LOOP --></a>).
</div>___________________________________________________________________________________________________________
<hr>
</div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 3714--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="number.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse62.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse62.html#tailclmse62.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="clmse63.html" >В-начало</a>&#x003E;&#x003C;<a 
href="xpack.html#clmse63.html" >Наверх</a>&#x003E;<br> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt;</div><a 
 id="tailclmse63.html"></a>
 
</body></html> 
