<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>11 Пакеты</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2013-03-12 14:38:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt; <br />&#x003C;<a 
href="clmse57.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse56.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse56.html#tailclmse56.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="#tailxpack.html">В-конец</a>&#x003E;&#x003C;<a 
href="clm.html#xpack.html" >Наверх</a>&#x003E;</div><h2 class="chapterHead"><span class="titlemark">Глава 11</span><br /><a 
href="clm.html#QQ2-72-119" id="x72-10900011">Пакеты</a></h2><div class="chapterTOCS">
    <span class="sectionToc" >11.1 <a 
href="clmse57.html#x73-11000011.1">Правила согласованности</a></span>
<br />    <span class="sectionToc" >11.2 <a 
href="clmse58.html#x74-11100011.2">Имена пакетов</a></span>
<br />    <span class="sectionToc" >11.3 <a 
href="clmse59.html#x75-11200011.3">Преобразование строк в символы</a></span>
<br />    <span class="sectionToc" >11.4 <a 
href="clmse60.html#x76-11300011.4">Экспортирование и импортирование символов</a></span>
<br />    <span class="sectionToc" >11.5 <a 
href="clmse61.html#x77-11400011.5">Конфликты имён</a></span>
<br />    <span class="sectionToc" >11.6 <a 
href="clmse62.html#x78-11500011.6">Системные пакеты</a></span>
<br />    <span class="sectionToc" >11.7 <a 
href="clmse63.html#x79-11600011.7">Функции и переменные для системы пакетов</a></span>
   </div>
<!--l. 1564--><p class="indent" >   В ранних реализациях Lisp&#x2019;а для всех символов использовалось одно
пространство имён. В больших Lisp&#x2019;овых системах, с модулями, написанными
разными программистами, случайные совпадения имён стали серьёзной
проблемой. Common Lisp решает эту проблему с помощью <em>системы пакетов</em>,
производной от системы пакетов, разработанной для Lisp Machine <span class="cite">[<a 
href="bib.html#XBLUE-LISPM">55</a>]</span>. Кроме
того система пакетов делает модульную структуру больших Lisp систем более
явной.
<em>
<!--l. 1572--><p class="indent" >   Пакет</em> — это структура данных, которая устанавливает связь между
именами символов (строковый тип) и самими символами. Во время работы
только один пакет является <em>текущим</em>, и этот пакет используется Lisp&#x2019;овым
считывателем для преобразовании строк-имён символов в сами символы.
Текущий пакет храниться в глобальной переменной <b><a 
href="symbols.html#x200-396032r32">*package*</a></b>. С помощью
<em>имени пакета</em> в имени символа существует возможность ссылаться на
символы других пакетов. Например, когда Common Lisp&#x2019;ом будет
прочтено имя <b>foo:bar</b>, то оно будет ссылаться на символ <b>bar</b> из пакета
<b>foo</b>. (Но при условии, что <b>bar</b> является экспортированным символом
из <b>foo</b>, то есть символом, который является видимым извне пакета
<b>foo</b>. Ссылка на внутренний символ требует удваивания двоеточия:
<b>foo::bar</b>.)
<!--l. 1586--><p class="indent" >   Связь символов и их имён, доступных в данном пакете, делится на два
вида: <em>внешняя</em> и <em>внутренняя</em>. Речь будет идти о символах доступных с
помощью этих связей, как о <em>внешних</em> или <em>внутренних</em> символах пакета, хотя
на самом деле различаются связи, а не символы. Внутри заданного пакета
имя ссылается максимум на один символ. Если оно ссылается на
символ, тогда этот символ в данном пакете является или внешним, или
внутренним.
                                                                          

                                                                          
<!--l. 1594--><p class="indent" >   Внешние символы являются частью интерфейса пакета, доступного для
других пакетов. Внешние символы должны быть аккуратно спроектированы
и предоставлены для пользователей этого пакета. Внутренние символы
предусмотрены только для внутреннего использования, и эти символы
обычно скрыты от других пакетов. Большинство символов создаются как
внутренние. Они становятся внешними, только если явно передаются в
команду <b><a 
href="symbols.html#x200-396391r391">export</a></b>. Таким образом внешние символы это то же, что и
экспортированные функции и переменные в других языках, поэтому внешние
символы иногда будут называться экспортированными от имени функции
<b><a 
href="symbols.html#x200-396391r391">export</a></b>.
<!--l. 1605--><p class="indent" >   Символ может встречаться во многих пакетах. Он будет всегда иметь
одно и то же имя, но в некоторых пакетах он может быть внешним (если его
экспортировали), а в других внутренним. С другой стороны, одно и то же
имя символа (строка) может ссылаться на различные символы в различных
пакетах.
<!--l. 1611--><p class="indent" >   Обычно, символ, который встречается в одном и более пакетах, будет
иметь только один родительский пакет, называемый <em>домашний пакет</em>
символа. Говорится, что такой пакет содержит данный символ. Все символы
содержат свойство, называемое <em>ячейка пакета</em>, которое хранит указатель на
домашний пакет. Символ, который имеет домашний пакет, называется
<em>пакетным</em>. Некоторые символы не имеют домашнего пакета. Они
называются <em>беспакетными</em>. Их ячейка пакета содержит значение
<b><a 
href="symbols.html#x200-396670r670">nil</a></b>.
<!--l. 1620--><p class="indent" >   Пакеты могут быть представлены как слои. С этой точки зрения, для
пользователя пакет выглядит как коллекция связей имён с внутренними и
внешними символами. Некоторые из этих связей могут устанавливаться
внутри самого пакета. Другие связи наследуются из других пакетов с
помощью конструкции <b><a 
href="symbols.html#x200-396995r995">use-package</a></b>. (Механизм такого наследования описан
ниже.) В дальнейшем, мы будем называть символ <em>доступным</em> в пакете, если
на него можно сослаться без указания имени пакета, вне зависимости от того
унаследована ли связь символов с именем или установлена текущим пакетом.
И мы будем называть символ <em>родным</em> в пакете, если связь установлена самим
пакетом, а не унаследована. Таким образом, <em>родной</em> символ в пакете
является <em>доступным</em>, но <em>доступный</em> символ не обязательно является
<em>родным</em>.
<!--l. 1633--><p class="indent" >   Символ называется <em>пакетным</em>, если он доступен в этом пакете и имеет
некоторый родительский пакет. Обычно все символы доступные в пакете
будут в собственности некоторого пакета, но иногда описываются случаи
                                                                          

                                                                          
доступности никому не принадлежащего (<em>беспакетного</em>) символа.
<!--l. 1639--><p class="indent" >   «<em>Пакетировать</em> символ!» означает сделать так, чтобы пакет стал
владельцем символа, если до этого было не так. Этот процесс выполняется
функцией <b><a 
href="symbols.html#x200-396504r504">intern</a></b>. Если символ прежде был бесхозным (никому не
принадлежал), тогда пакет становится его владельцем (домашним пакетом).
Но если символ уже принадлежал кому-то, то домашний пакет не
меняется.
<!--l. 1646--><p class="indent" >   «<em>Лишить</em> символ пакета» означает убрать его из пакета. Данный процесс
выполняется функцией <b><a 
href="symbols.html#x200-396980r980">unintern</a></b>. FIXME







                                                                          

                                                                          
   <div id="bottomlinks">&#x003C;<a 
href="clmse57.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse56.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse56.html#tailclmse56.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="xpack.html" >В-начало</a>&#x003E;&#x003C;<a 
href="clm.html#xpack.html" >Наверх</a>&#x003E;<br> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt;</div><a 
 id="tailxpack.html"></a>
 
</body></html> 
