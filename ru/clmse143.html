<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Условное выполнение</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2013-03-12 14:38:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt; <br />&#x003C;<a 
href="clmse144.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse142.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse142.html#tailclmse142.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="#tailclmse143.html">В-конец</a>&#x003E;&#x003C;<a 
href="clmch26.html#clmse143.html" >Наверх</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">26.19
</span> <a 
href="clm.html#QQ2-174-293" id="x174-25200026.19">Условное выполнение</a></h3>
<!--l. 2065--><p class="noindent" >The loop keywords <b><a 
href="symbols.html#x200-396488r488">if</a></b>, <b><a 
href="symbols.html#x200-397009r1009">when</a></b>, and <b><a 
href="symbols.html#x200-396982r982">unless</a></b> designate constructs that are useful
when you want some loop clauses to operate under a speciﬁed condition.
<!--l. 2069--><p class="indent" >   Ключевые символы <b><a 
href="symbols.html#x200-396488r488">if</a></b>, <b><a 
href="symbols.html#x200-397009r1009">when</a></b> и <b><a 
href="symbols.html#x200-396982r982">unless</a></b> обозначают конструкцию, которая
полезна, когда вы хотите выполнить некоторые действия только при
выполнении некоторого условия.
<!--l. 2073--><p class="indent" >   If the speciﬁed condition is true, the succeeding loop clause is executed. If the
speciﬁed condition is not true, the succeeding clause is skipped, and program
control moves to the clause that follows the loop keyword <b>else</b>. If the speciﬁed
condition is not true and no <b>else</b> clause is speciﬁed, the entire conditional
construct is skipped. Several clauses can be connected into one compound clause
with the loop keyword <b><a 
href="symbols.html#x200-396098r98">and</a></b>. The end of the conditional clause can be marked with
the keyword <b>end</b>.
<!--l. 2082--><p class="indent" >   Если условие истинно, выполняется следующее выражение. Если условие
ложно, следующее выражение пропускается и выполнение переходит к
выражению в ветке <b>else</b>. Если условие ложно и ветка <b>else</b> отсутствует, всё
выражение просто пропускается. Несколько выражений могут объединены в
одно с помощью <b><a 
href="symbols.html#x200-396098r98">and</a></b>. Конец условного выражения можно обозначить
символом <b>end</b>.
<div class="defloop">
<div class="defmacheader">
<!--l. 2090--><p class="indent" >   <div class="tabbing">
 <em>[Выражение цикла]</em> <b>if</b> <a 
 id="dx174-252001"></a>expr clause {<b>and</b> clause}*[<b>else</b> clause {<b>and</b> clause}*] [<b>end</b>]
   <br>
<!--l. 2091--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 2091--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
 <em>[Выражение цикла]</em> <b>when</b> <a 
 id="dx174-252002"></a>expr clause {<b>and</b> clause}*[<b>else</b> clause {<b>and</b> clause}*] [<b>end</b>]
   <br>
<!--l. 2093--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 2093--><p class="indent" >   <div class="tabbing">
 <em>[Выражение цикла]</em> <b>unless</b> <a 
 id="dx174-252003"></a>expr clause {<b>and</b> clause}*[<b>else</b> clause {<b>and</b> clause}*] [<b>end</b>]
   <br>
<!--l. 2096--><p class="noindent" ></div>
</div>
<!--l. 2097--><p class="indent" >   The constructs <b><a 
href="symbols.html#x200-397009r1009">when</a></b> and <b><a 
href="symbols.html#x200-396488r488">if</a></b> allow conditional execution of loop clauses. These
constructs are synonyms and can be used interchangeably.
<!--l. 2101--><p class="indent" >   Конструкции <b><a 
href="symbols.html#x200-397009r1009">when</a></b> и <b><a 
href="symbols.html#x200-396488r488">if</a></b> выполняют действия в зависимости от
условия. Эти конструкции являются синонимами и соответственно
взаимозаменяемы.
<!--l. 2104--><p class="indent" >   If the value of the test expression <em>expr</em> is non-<b><a 
href="symbols.html#x200-396670r670">nil</a></b>, the expression <em>clause1</em> is
evaluated. If the test expression evaluates to <b><a 
href="symbols.html#x200-396670r670">nil</a></b> and an <b>else</b> construct is speciﬁed,
the statements that follow the <b>else</b> are evaluated; otherwise, control passes to the
next clause.
<!--l. 2109--><p class="indent" >   Если значение условия <em>expr</em> не-<b><a 
href="symbols.html#x200-396670r670">nil</a></b>, выполняется выражение <em>clause1</em>. Если
условие возвращает <b><a 
href="symbols.html#x200-396670r670">nil</a></b> и указана ветка <b>else</b> выполняются выражения в этой
ветке, иначе выполнение переходит к следующему выражению.
<!--l. 2114--><p class="indent" >   The <b><a 
href="symbols.html#x200-396982r982">unless</a></b> construct is equivalent to <b><a 
href="symbols.html#x200-397009r1009">when</a></b> (<b><a 
href="symbols.html#x200-396676r676">not</a></b> <em>expr</em>) and <b><a 
href="symbols.html#x200-396488r488">if</a></b> (<b><a 
href="symbols.html#x200-396676r676">not</a></b> <em>expr</em>). If
the value of the test expression <em>expr</em> is <b><a 
href="symbols.html#x200-396670r670">nil</a></b>, the expression <em>clause1</em> is evaluated. If
the test expression evaluates to non-<b><a 
href="symbols.html#x200-396670r670">nil</a></b> and an <b>else</b> construct is speciﬁed, the
statements that follow the <b>else</b> are evaluated; otherwise, control passes to the
next clause. [Compare this to the <em>macro</em> <b><a 
href="symbols.html#x200-396982r982">unless</a></b>, which does not allow an “else”
part—or do I mean a “then” part?! Ugh. To prevent confusion, I strongly
recommend as a matter of style that <b>else</b> not be used with <b><a 
href="symbols.html#x200-396982r982">unless</a></b> loop
clauses.—GLS]
<!--l. 2126--><p class="indent" >   Конструкция <b><a 
href="symbols.html#x200-396982r982">unless</a></b> эквивалентна конструкциям <b><a 
href="symbols.html#x200-397009r1009">when</a></b> (<b><a 
href="symbols.html#x200-396676r676">not</a></b> <em>expr</em>) и <b><a 
href="symbols.html#x200-396488r488">if</a></b>
(<b><a 
href="symbols.html#x200-396676r676">not</a></b> <em>expr</em>). Если значение условия <b><a 
href="symbols.html#x200-396670r670">nil</a></b>, выполняется выражение <em>clause1</em>. Если
условие не-<b><a 
href="symbols.html#x200-396670r670">nil</a></b> выполняется ветка <b>else</b>, иначе выполнение переходит к
следующей конструкции.
<!--l. 2132--><p class="indent" >   The <em>clause</em> arguments must be either accumulation, unconditional, or
                                                                          

                                                                          
conditional clauses (see section <a 
href="clmse130.html#x161-23600026.6.3">26.6.3<!--tex4ht:ref: LOOP-KINDS-SECTION --></a>). Clauses that follow the test expression
can be grouped by using the loop keyword <b><a 
href="symbols.html#x200-396098r98">and</a></b> to produce a compound
clause.
<!--l. 2138--><p class="indent" >   Аргументы <em>clause</em> должны быть или накоплением значения, безусловным
или условным выполнением (смотрите раздел <a 
href="clmse130.html#x161-23600026.6.3">26.6.3<!--tex4ht:ref: LOOP-KINDS-SECTION --></a>). Выражения,
которые следуют после условия, могут группироваться с помощью
<b><a 
href="symbols.html#x200-396098r98">and</a></b>.
<!--l. 2143--><p class="indent" >   The loop keyword <b>it</b> can be used to refer to the result of the test expression in
a clause. If multiple clauses are connected with <b><a 
href="symbols.html#x200-396098r98">and</a></b>, the <b>it</b> construct must be
used in the ﬁrst clause in the block. Since <b>it</b> is a loop keyword, <b>it</b> may not be used
as a local variable within a loop.
<!--l. 2149--><p class="indent" >   Для ссылки на результат условия может использоваться символ <b>it</b>.
Если выражения были сгруппированы с помощью <b><a 
href="symbols.html#x200-396098r98">and</a></b>, <b>it</b> должна
использоваться только в первом выражении в блоке. Таким образом <b>it</b>
не может использоваться в качестве локальной переменной внутри
<b><a 
href="symbols.html#x200-396577r577">loop</a></b>.
<!--l. 2155--><p class="indent" >   If <b><a 
href="symbols.html#x200-397009r1009">when</a></b> or <b><a 
href="symbols.html#x200-396488r488">if</a></b> clauses are nested, each <b>else</b> is paired with the closest preceding
<b><a 
href="symbols.html#x200-397009r1009">when</a></b> or <b><a 
href="symbols.html#x200-396488r488">if</a></b> construct that has no associated <b>else</b>.
<!--l. 2159--><p class="indent" >   Если <b><a 
href="symbols.html#x200-397009r1009">when</a></b> или <b><a 
href="symbols.html#x200-396488r488">if</a></b> вложены, каждый <b>else</b> относится к ближайшему
предшествующему <b><a 
href="symbols.html#x200-397009r1009">when</a></b> или <b><a 
href="symbols.html#x200-396488r488">if</a></b>, у которого ещё не было <b>else</b>.
<!--l. 2163--><p class="indent" >   The optional loop keyword <b>end</b> marks the end of the clause. If this keyword is
not speciﬁed, the next loop keyword marks the end. You can use <b>end</b> to
distinguish the scoping of compound clauses. <div class="lisp"><tt><div class="tabbing">
;;; Group conditional clauses into a block.
   <br>                 (loop for i in numbers-list<br>                       when (oddp i)<br>
        do (print i)<br>                      and collect i into odd-numbers<br>
        and do (terpri)<br>                               else     ;<b>I</b> is even<br>
        collect i into even-numbers<br>                               ﬁnally<br>
        (return (values odd-numbers even-numbers)))<br>
<!--l. 2177--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2178--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
;;; Collect numbers larger than 3.
   <br>            (loop for i in &#x2019;(1 2 3 4 5 6)<br>                  when (and (&#x003E; i 3) i)<br>
      collect it)     ;<b>it</b> refers to <b>(and (&#x003E; i 3) i)</b><br>             <span class="math"> ⇒</span> (4 5 6)<br>
<!--l. 2184--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2185--><p class="indent" >   <div class="tabbing">
;;; Find a number in a list.
   <br>                                                            (loop for i in &#x2019;(1 2 3 4 5 6)<br>
      when (and (&#x003E; i 3) i)<br>                                     return it)<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 2191--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2192--><p class="indent" >   <div class="tabbing">
;;; The preceding example is similar to the following one.
   <br>          (loop for i in &#x2019;(1 2 3 4 5 6)<br>                thereis (and (&#x003E; i 3) i))<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 2197--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2198--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
;;; An example of using UNLESS with ELSE (yuk).                  —GLS
   <br>                             (loop for turtle in teenage-mutant-ninja-turtles do<br>
  (loop for x in &#x2019;(joker brainiac shredder krazy-kat)<br>
        unless (evil x)<br>                do (eat (make-pizza :anchovies t))<br>
        else unless (and (eq x &#x2019;shredder) (attacking-p x))<br>
               do (cut turtle slack) ;When the evil Shredder attacks,<br>
             else (ﬁght turtle x))) ; those turtle boys don&#x2019;t cut no slack<br>
<!--l. 2207--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2209--><p class="indent" >   <div class="tabbing">
;;; Nest conditional clauses.
   <br>                                                                         (loop for i in list<br>
      when (numberp i)<br>                               when (bignump i)<br>
          collect i into big-numbers<br>        else     ;Not <b>(bignump i)</b><br>
          collect i into other-numbers<br>
      else     ;Not <b>(numberp i)</b><br>                     when (symbolp i)<br>
          collect i into symbol-list<br>          else     ;Not <b>(symbolp i)</b><br>
          (error &#x0022;found a funny value in list ~S, value ~S~%&#x0022;<br>
                &#x0022;list i))<br>
<br>             ;;; Without the END marker, the last AND would apply to the<br>
;;; inner IF rather than the outer one.<br>               (loop for x from 0 to 3<br>
      do (print x)<br>                                   if (zerop (mod x 2))<br>
        do (princ &#x0022; a&#x0022;)<br>                        and if (zerop (ﬂoor x 2))<br>
                do (princ &#x0022; b&#x0022;)<br>                                   end<br>
          and do (princ &#x0022; c&#x0022;))<br>
<!--l. 2234--><p class="noindent" ></div>
</tt>
</div>
                                                                          

                                                                          
<!--l. 2236--><p class="indent" >   Конец можно обозначить необязательным символом <b>end</b>. Если этот
символ не указан, конструкция заканчивается там, где начинается
следующая, обозначенная символом. Вы можете использовать <b>end</b> для
ограничения пространство составных выражений. <div class="lisp"><tt><div class="tabbing">
;;; Группирует условные выражение в блок.
   <br>                 (loop for i in numbers-list<br>                       when (oddp i)<br>
        do (print i)<br>                      and collect i into odd-numbers<br>
        and do (terpri)<br>                               else     ;<b>I</b> is even<br>
        collect i into even-numbers<br>                               ﬁnally<br>
        (return (values odd-numbers even-numbers)))<br>
<!--l. 2251--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2252--><p class="indent" >   <div class="tabbing">
;;; Накапливает числа, большие чем 3.
   <br>            (loop for i in &#x2019;(1 2 3 4 5 6)<br>                  when (and (&#x003E; i 3) i)<br>
      collect it)     ;<b>it</b> ссылается на <b>(and (&#x003E; i 3) i)</b><br>       <span class="math"> ⇒</span> (4 5 6)<br>
<!--l. 2258--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2259--><p class="indent" >   <div class="tabbing">
;;; Ищет числа в списке.
   <br>                                                            (loop for i in &#x2019;(1 2 3 4 5 6)<br>
      when (and (&#x003E; i 3) i)<br>                                     return it)<br>
   <span class="math"> ⇒</span> 4<br>
                                                                          

                                                                          
<!--l. 2265--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2266--><p class="indent" >   <div class="tabbing">
;;; То же что и в предыдущем примере.
   <br>          (loop for i in &#x2019;(1 2 3 4 5 6)<br>                thereis (and (&#x003E; i 3) i))<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 2271--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2272--><p class="indent" >   <div class="tabbing">
;;; Пример использования UNLESS с ELSE.                       —GLS
   <br>                             (loop for turtle in teenage-mutant-ninja-turtles do<br>
  (loop for x in &#x2019;(joker brainiac shredder krazy-kat)<br>
        unless (evil x)<br>                do (eat (make-pizza :anchovies t))<br>
        else unless (and (eq x &#x2019;shredder) (attacking-p x))<br>
               do (cut turtle slack) ;Когда злой Шрёдер атакует,<br>
             else (ﬁght turtle x))) ; эти черепашки-ниндзя дают ему отпор.<br>
<!--l. 2281--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 2283--><p class="indent" >   <div class="tabbing">
;;; Вложенные условные выражения.
                                                                          

                                                                          
   <br>                                                                         (loop for i in list<br>
      when (numberp i)<br>                               when (bignump i)<br>
          collect i into big-numbers<br>        else     ;Not <b>(bignump i)</b><br>
          collect i into other-numbers<br>       else     ;Not <b>(numberp i)</b><br>
        when (symbolp i)<br>                      collect i into symbol-list<br>
        else     ;Not <b>(symbolp i)</b><br>          (error &#x0022;нашёл интересное значение в списке ~S, значение ~S~%&#x0022;<br>
                &#x0022;list i))<br>                                                <br>
;;; Без маркера END последнее AND должно примениться к<br>
;;; внутреннему IF, а не к внешнему.<br>               (loop for x from 0 to 3<br>
      do (print x)<br>                                   if (zerop (mod x 2))<br>
        do (princ &#x0022; a&#x0022;)<br>                        and if (zerop (ﬂoor x 2))<br>
                do (princ &#x0022; b&#x0022;)<br>                                   end<br>
          and do (princ &#x0022; c&#x0022;))<br>
<!--l. 2308--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
                                                                          

                                                                          
<!--l. 2312--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="clmse144.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse142.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse142.html#tailclmse142.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="clmse143.html" >В-начало</a>&#x003E;&#x003C;<a 
href="clmch26.html#clmse143.html" >Наверх</a>&#x003E;<br> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt;</div><a 
 id="tailclmse143.html"></a>
 
</body></html> 
